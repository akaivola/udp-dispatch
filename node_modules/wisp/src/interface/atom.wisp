(ns wisp.interface.atom
  (:require [wisp.interface.protocol :refer [satisfies?]]))

(defprotocol IAtom)

(defprotocol IReset
  "Sets the value of atom to new value without regard for the
  current value. Returns value."
  (reset! [identifier value]))

(defprotocol ISwap
  "Atomically swaps the value of atom to be:
  (apply f current-value-of-atom args). Note that f may be called
  multiple times, and thus should be free of side effects. Returns
  the value that was swapped in."
  (swap! [inetifier f]
         [identifier f a]
         [identifier f a b]
         [identifier f a b xs]))

(defprotocol IValidate
  (validate [identifier value]))

(defn atom?
  [x]
  (satisfies? IAtom x))
